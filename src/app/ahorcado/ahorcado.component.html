<div class="main-page">

    <h1 class="title">Ahorcado</h1>

    <div *ngIf="!showRanking"> 
        <!-- INICIAR PARTIDA -->
        <div class='input-container' *ngIf="!juego">
            <input class="name-input" placeholder="Nombre" [(ngModel)]="nombre" [disabled]="loading" />

            <select class="difficulty-input" [(ngModel)]="dificultad" [disabled]="loading">
                <option value="" disabled selected>Dificultad</option>
                <option value="FACIL">Facil</option>
                <option value="MEDIA">Media</option>
                <option value="DIFICIL">Dif√≠cil</option>
            </select>

            <button class="btn btn-iniciar" 
                    [class.btn-disabled]="!nombre || !dificultad" 
                    (click)="iniciarPartida()" 
                    [disabled]="loading || !nombre || !dificultad"> 
                    Iniciar partida 
            </button>

            <div class="divisor"></div>

            <button class="btn btn-ranking" (click)="verRanking()">Ver Ranking</button>
        </div>

        <!-- JUEGO -->
        <div *ngIf="juego">

            <div class="partida-stats">
                <div>Nombre: {{juego.nombreJugador}}</div>
                <div [class.facil]="juego.dificultad === 'FACIL'"
                     [class.media]="juego.dificultad === 'MEDIA'"
                     [class.dificil]="juego.dificultad === 'DIFICIL'"
                    >
                    Dificultad: {{juego.dificultad}}
                </div>
                <div>Vidas restantes: {{juego.cantActualVidas}}</div>

            </div>

            <div class="img-container">
                <img [src]="'/assets/img/' + juego.cantActualVidas + '.png'" alt="imagen ahorcado">
                <div class="palabra">{{juego.palabra}}</div>
            </div>

            <div>
                <div *ngFor="let row of teclado">
                    <button *ngFor="let tecla of row" 
                            (click)="enviarLetra(tecla)" 
                            [disabled]="tecla.disabled"
                            class="btn btn-tecla">
                        {{tecla.letra}}
                    </button>
                </div>
            </div>
            
            <div class="arriesgadas-container" *ngIf="juego.letrasArriesgadas.length">
                Letras arriesgadas
                <div class="arriesgadas">
                    <div *ngFor="let letra of juego.letrasArriesgadas">
                        {{letra}}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- RANKING -->
    <div class="ranking-container" *ngIf="showRanking && ranking && ranking.length">  

        <table>
            <tr>
                <th>Nombre</th>
                <th>Puntaje</th>
            </tr>
            <tr *ngFor="let row of ranking">
                <th>{{row.nombre}}</th>
                <th>{{row.puntaje}}</th>
            </tr>
        </table>
         
        <button class="btn btn-volver" (click)="back()">Volver</button>
    </div>




    <!-- SPINNER -->
    <div class="lds-ring" *ngIf="loading">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>

</div>


<!-- The Modal -->
<div class="modal" [ngStyle]="{display: showModal ? 'block' : 'none'}">

    <!-- Modal content -->
    <div class="modal-content" *ngIf="juego">
        <p>{{juego.estadoPartida}}</p>
        <p *ngIf="juego.puntaje">{{juego.puntaje}}</p>

        <div class="buttons-container">
            <button class="btn btn-rein" (click)="reiniciar()">Reiniciar</button>
            <button class="btn btn-rank" (click)="verRanking()">Ver Ranking</button>
        </div>
    </div>
  
</div>